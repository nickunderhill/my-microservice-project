# ๐ ะะฝััะฐััััะบัััะฝะธะน ะฟัะพะตะบั ะฝะฐ Terraform ัะฐ Kubernetes (EKS)

## ๐ ะะผััั

- [ะะณะปัะด ะฟัะพะตะบัั](#ะพะณะปัะด-ะฟัะพะตะบัั)
- [ะััััะตะบัััะฐ](#ะฐััััะตะบัััะฐ)
- [ะะพะดัะปั](#ะผะพะดัะปั)
- [ะะตัะตะดัะผะพะฒะธ](#ะฟะตัะตะดัะผะพะฒะธ)
- [ะััะฐะฝะพะฒะปะตะฝะฝั ัะฐ ะฝะฐะปะฐัััะฒะฐะฝะฝั](#ะฒััะฐะฝะพะฒะปะตะฝะฝั-ัะฐ-ะฝะฐะปะฐัััะฒะฐะฝะฝั)
- [ะะธะบะพัะธััะฐะฝะฝั Terraform](#ะฒะธะบะพัะธััะฐะฝะฝั-terraform)
- [ะะตะฟะปะพะน Django ะทะฐััะพััะฝะบั ะท Helm](#ะดะตะฟะปะพะน-django-ะทะฐััะพััะฝะบั-ะท-helm)
- [Jenkins CI/CD ะผะพะดัะปั](#jenkins-cicd-ะผะพะดัะปั)
- [ะะฑะตััะณะฐะฝะฝั ัะฐ PVC](#ะทะฑะตััะณะฐะฝะฝั-ัะฐ-pvc)
- [ะะตะทะฟะตะบะฐ](#ะฑะตะทะฟะตะบะฐ)
- [Troubleshooting](#troubleshooting)
- [ะััะตะฝะทัั](#ะปััะตะฝะทัั)

---

## ๐ฏ ะะณะปัะด ะฟัะพะตะบัั

ะฆะตะน ะฟัะพะตะบั ะฐะฒัะพะผะฐัะธะทัั ัะพะทะณะพััะฐะฝะฝั AWS-ัะฝััะฐััััะบัััะธ ะดะปั ะผัะบัะพัะตัะฒััะฝะพะณะพ
ะดะพะดะฐัะบั ะท ะฒะธะบะพัะธััะฐะฝะฝัะผ Terraform, Helm ัะฐ Kubernetes (EKS). ะะบะปััะฐั CI/CD ะท
Jenkins, ะดะตะฟะปะพะน Django ะทะฐััะพััะฝะบั, ะทะฑะตััะณะฐะฝะฝั ััะฐะฝั ั S3, ัะฐ ะฐะฒัะพะผะฐัะธัะฝะต
ะผะฐัััะฐะฑัะฒะฐะฝะฝั.

---

## ๐๏ธ ะััััะตะบัััะฐ

```
โโโโโโโโโโโโโโ   โโโโโโโโโโโโโโ   โโโโโโโโโโโโโโ   โโโโโโโโโโโโโโ   โโโโโโโโโโโโโโ
โ   VPC      โ   โ   ECR      โ   โ   S3       โ   โ   EKS      โ   โ  Jenkins   โ
โ  Module    โ   โ  Module    โ   โ  Backend   โ   โ  Module    โ   โ  Module    โ
โโโโโโโโโโโโโโ   โโโโโโโโโโโโโโ   โโโโโโโโโโโโโโ   โโโโโโโโโโโโโโ   โโโโโโโโโโโโโโ
```

- VPC: ะฟัะธะฒะฐัะฝั/ะฟัะฑะปััะฝั ะฟัะดะผะตัะตะถั, NAT, IGW
- ECR: Docker-ัะตะฟะพะทะธัะพััะน ะดะปั ะพะฑัะฐะทัะฒ
- S3/DynamoDB: ะฑะตะบะตะฝะด ะดะปั ััะฐะฝั Terraform
- EKS: Kubernetes ะบะปะฐััะตั ะดะปั Django, Jenkins
- Jenkins: CI/CD ะฟะฐะนะฟะปะฐะนะฝะธ, seed-job, ัะฝัะตะณัะฐััั ะท GitHub

---

## ๐ฆ ะะพะดัะปั

- **VPC** (`modules/vpc`): ััะฒะพััั VPC, ะฟัะดะผะตัะตะถั, ะผะฐัััััะธ, NAT/IGW
- **ECR** (`modules/ecr`): ััะฒะพััั ECR-ัะตะฟะพะทะธัะพััะน ะดะปั Docker-ะพะฑัะฐะทัะฒ
- **S3-backend** (`modules/s3-backend`): S3 ะฑะฐะบะตั + DynamoDB ะดะปั ััะฐะฝั
- **EKS** (`modules/eks`): ะบะปะฐััะตั Kubernetes, node group, IAM
- **Jenkins** (`modules/jenkins`): ะดะตะฟะปะพะน Jenkins ัะตัะตะท Helm, seed-job, PVC
- **Django Helm Chart** (`lesson-7/charts`): ะดะตะฟะปะพะน Django ะทะฐััะพััะฝะบั ะท HPA

---

## ๐ง ะะตัะตะดัะผะพะฒะธ

- AWS ะฐะบะฐัะฝั ะท ะฟัะฐะฒะฐะผะธ admin
- [Terraform 1.0+](https://www.terraform.io/downloads.html)
- [AWS CLI](https://aws.amazon.com/cli/)
- [kubectl](https://kubernetes.io/docs/tasks/tools/)
- [Helm](https://helm.sh/)
- Docker (ะดะปั ะทะฑััะบะธ ะพะฑัะฐะทัะฒ)

---

## โ๏ธ ะััะฐะฝะพะฒะปะตะฝะฝั ัะฐ ะฝะฐะปะฐัััะฒะฐะฝะฝั

1. ะะปะพะฝัะฒะฐัะธ ัะตะฟะพะทะธัะพััะน:
   ```sh
   git clone <repo-url>
   cd lesson-7
   ```
2. ะะฐะปะฐัััะฒะฐัะธ AWS CLI:
   ```sh
   aws configure
   ```
3. ะะฝัััะฐะปัะทัะฒะฐัะธ Terraform:
   ```sh
   terraform init
   ```

---

## ๐ ะะธะบะพัะธััะฐะฝะฝั Terraform

- ะะตัะตะณะปัะด ะฟะปะฐะฝั:
  ```sh
  terraform plan
  ```
- ะะฐััะพััะฒะฐะฝะฝั:
  ```sh
  terraform apply
  ```
- ะะธะดะฐะปะตะฝะฝั:
  ```sh
  terraform destroy
  ```

---

## ๐ ะะตะฟะปะพะน Django ะทะฐััะพััะฝะบั ะท Helm

1. **ะะฑััะบะฐ ัะฐ ะฟัั Docker-ะพะฑัะฐะทั:**
   ```sh
   docker build --platform linux/amd64 -t <ecr-repo>:<tag> .
   docker push <ecr-repo>:<tag>
   ```
2. **ะะฝะพะฒััั `lesson-7/charts/values.yaml` ะท ะฒะฐัะธะผ ะพะฑัะฐะทะพะผ.**
3. **ะะตะฟะปะพะน ัะตัะตะท Helm:**
   ```sh
   helm upgrade --install lesson-7 ./lesson-7/charts
   ```
4. **ะะฝะฐะนะดััั EXTERNAL-IP:**
   ```sh
   kubectl get svc
   ```
   ะัะดะบัะธะนัะต ั ะฑัะฐัะทะตัั (ะฟะพัั 80 ะฐะฑะพ 8000).
5. **HPA:** ะะฐัััะฐะฑัะฒะฐะฝะฝั ะฒัะด 2 ะดะพ 6 ะฟะพะดัะฒ ะฟัะธ CPU > 70% (ะฝะฐะปะฐัััะฒะฐะฝะฝั ั
   values.yaml).

---

## ๐งฉ Jenkins CI/CD ะผะพะดัะปั

- **ะะตะฟะปะพะน ัะตัะตะท Terraform:** ะผะพะดัะปั ะฐะฒัะพะผะฐัะธัะฝะพ ััะฒะพััั Jenkins ั EKS ัะตัะตะท
  Helm.
- **ะะฑะตััะณะฐะฝะฝั:** PVC ะท EBS (StorageClass `gp2` ะฐะฑะพ `ebs-sc`).
- **Seed-job:** ะฐะฒัะพะผะฐัะธัะฝะพ ััะฒะพััั pipeline ะดะปั Django ะท GitHub-ัะตะฟะพะทะธัะพััั
  (Job DSL).
- **PAT:** ะะฑะตััะณะฐะนัะต GitHub PAT ัะบ Jenkins Credential (`github-token`). ะะต
  ัะฐัะดะบะพะดััะต ั ัะฐะนะปะฐั!
- **ะะพัััะฟ:**
  ```sh
  kubectl get svc -n jenkins
  ```
  ะัะดะบัะธะนัะต EXTERNAL-IP:8080 ั ะฑัะฐัะทะตัั.

---

## ๐ Argo CD ะผะพะดัะปั

- **ะะตะฟะปะพะน ัะตัะตะท Terraform:** ะผะพะดัะปั ะฐะฒัะพะผะฐัะธัะฝะพ ััะฒะพััั Argo CD ั EKS ัะตัะตะท
  Helm.
- **ะะพัััะฟ:**

  ```sh
  kubectl get svc -n argocd
  ```

  ะัะดะบัะธะนัะต EXTERNAL-IP:8080 ั ะฑัะฐัะทะตัั.

  ะะพะณัะฝ: admin

  ะะฐัะพะปั:

  ```sh
  kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d
  ```

---

## ๐ ะะตะทะฟะตะบะฐ

- ะะธะบะพัะธััะพะฒัะนัะต IAM ัะพะปั, ะฝะต access keys
- ะจะธัััะนัะต ััะฐะฝ ั S3
- ะะต ะทะฑะตััะณะฐะนัะต ัะตะบัะตัะธ ั ะฒัะดะบัะธัะพะผั ะฒะธะณะปัะดั
- ะะธะบะพัะธััะพะฒัะนัะต Jenkins Credentials ะดะปั PAT
- ะะพะฝััะพััะต ัะตััััะธ ัะฐ ะปะพะณะธ

---

## ๐๏ธ Troubleshooting

- **PVC Pending:** ะฟะตัะตะฒัััะต StorageClass, ะฟัะฐะฒะฐ AWS, ะปะพะณะธ pod-ะฐ
- **Jenkins ะฝะต ััะฐัััั:** ะฟะตัะตะฒัััะต ะปะพะณะธ pod-ะฐ, PVC, ัะตััััะธ
- **LoadBalancer ะฑะตะท EXTERNAL-IP:** ะทะฐัะตะบะฐะนัะต ะฐะฑะพ ะฟะตัะตะฒัััะต cloud-ะฟัะพะฒะฐะนะดะตัะฐ
- **kubectl ะฝะต ะฟัะดะบะปััะฐััััั:** ะพะฝะพะฒััั kubeconfig ัะตัะตะท AWS CLI
- **Helm release failed:** ะฒะธะดะฐะปััั ััะฐัะธะน release
  (`helm uninstall <name> -n <ns>`)

---

## ๐ ะััะตะฝะทัั

ะฆะตะน ะฟัะพะตะบั ััะฒะพัะตะฝะพ ะดะปั ะฝะฐะฒัะฐะปัะฝะธั ััะปะตะน.

---

**ะะฒัะพั:** [ะะพะดะพะฟัะธะณะพัะฐ ะะธะบะพะปะฐ]  
**ะะตัััั:** 0.0.9
