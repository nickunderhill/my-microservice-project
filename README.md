# üöÄ –Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ Terraform —Ç–∞ Kubernetes (EKS)

## üìã –ó–º—ñ—Å—Ç

- [–û–≥–ª—è–¥ –ø—Ä–æ–µ–∫—Ç—É](#–æ–≥–ª—è–¥-–ø—Ä–æ–µ–∫—Ç—É)
- [–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞)
- [–ú–æ–¥—É–ª—ñ](#–º–æ–¥—É–ª—ñ)
- [–ü–µ—Ä–µ–¥—É–º–æ–≤–∏](#–ø–µ—Ä–µ–¥—É–º–æ–≤–∏)
- [–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è](#–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è-—Ç–∞-–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è)
- [–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Terraform](#–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è-terraform)
- [–î–µ–ø–ª–æ–π Django –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –∑ Helm](#–¥–µ–ø–ª–æ–π-django-–∑–∞—Å—Ç–æ—Å—É–Ω–∫—É-–∑-helm)
- [Jenkins CI/CD –º–æ–¥—É–ª—å](#jenkins-cicd-–º–æ–¥—É–ª—å)
- [–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ç–∞ PVC](#–∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è-—Ç–∞-pvc)
- [–ë–µ–∑–ø–µ–∫–∞](#–±–µ–∑–ø–µ–∫–∞)
- [Troubleshooting](#troubleshooting)
- [–õ—ñ—Ü–µ–Ω–∑—ñ—è](#–ª—ñ—Ü–µ–Ω–∑—ñ—è)

---

## üéØ –û–≥–ª—è–¥ –ø—Ä–æ–µ–∫—Ç—É

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—î —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è AWS-—ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–ª—è –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω–æ–≥–æ
–¥–æ–¥–∞—Ç–∫—É –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Terraform, Helm —Ç–∞ Kubernetes (EKS). –í–∫–ª—é—á–∞—î CI/CD –∑
Jenkins, –¥–µ–ø–ª–æ–π Django –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É, –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Å—Ç–∞–Ω—É —É S3, —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ
–º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è.

---

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   VPC      ‚îÇ   ‚îÇ   ECR      ‚îÇ   ‚îÇ   S3       ‚îÇ   ‚îÇ   EKS      ‚îÇ   ‚îÇ  Jenkins   ‚îÇ
‚îÇ  Module    ‚îÇ   ‚îÇ  Module    ‚îÇ   ‚îÇ  Backend   ‚îÇ   ‚îÇ  Module    ‚îÇ   ‚îÇ  Module    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

- VPC: –ø—Ä–∏–≤–∞—Ç–Ω—ñ/–ø—É–±–ª—ñ—á–Ω—ñ –ø—ñ–¥–º–µ—Ä–µ–∂—ñ, NAT, IGW
- ECR: Docker-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –¥–ª—è –æ–±—Ä–∞–∑—ñ–≤
- S3/DynamoDB: –±–µ–∫–µ–Ω–¥ –¥–ª—è —Å—Ç–∞–Ω—É Terraform
- EKS: Kubernetes –∫–ª–∞—Å—Ç–µ—Ä –¥–ª—è Django, Jenkins
- Jenkins: CI/CD –ø–∞–π–ø–ª–∞–π–Ω–∏, seed-job, —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ GitHub

---

## üì¶ –ú–æ–¥—É–ª—ñ

- **VPC** (`modules/vpc`): —Å—Ç–≤–æ—Ä—é—î VPC, –ø—ñ–¥–º–µ—Ä–µ–∂—ñ, –º–∞—Ä—à—Ä—É—Ç–∏, NAT/IGW
- **ECR** (`modules/ecr`): —Å—Ç–≤–æ—Ä—é—î ECR-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –¥–ª—è Docker-–æ–±—Ä–∞–∑—ñ–≤
- **S3-backend** (`modules/s3-backend`): S3 –±–∞–∫–µ—Ç + DynamoDB –¥–ª—è —Å—Ç–∞–Ω—É
- **EKS** (`modules/eks`): –∫–ª–∞—Å—Ç–µ—Ä Kubernetes, node group, IAM
- **Jenkins** (`modules/jenkins`): –¥–µ–ø–ª–æ–π Jenkins —á–µ—Ä–µ–∑ Helm, seed-job, PVC
- **Django Helm Chart** (`lesson-7/charts`): –¥–µ–ø–ª–æ–π Django –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –∑ HPA

---

## üîß –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

- AWS –∞–∫–∞—É–Ω—Ç –∑ –ø—Ä–∞–≤–∞–º–∏ admin
- [Terraform 1.0+](https://www.terraform.io/downloads.html)
- [AWS CLI](https://aws.amazon.com/cli/)
- [kubectl](https://kubernetes.io/docs/tasks/tools/)
- [Helm](https://helm.sh/)
- Docker (–¥–ª—è –∑–±—ñ—Ä–∫–∏ –æ–±—Ä–∞–∑—ñ–≤)

---

## ‚öôÔ∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

1. –ö–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:
   ```sh
   git clone <repo-url>
   cd lesson-7
   ```
2. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ AWS CLI:
   ```sh
   aws configure
   ```
3. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ Terraform:
   ```sh
   terraform init
   ```

---

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Terraform

- –ü–µ—Ä–µ–≥–ª—è–¥ –ø–ª–∞–Ω—É:
  ```sh
  terraform plan
  ```
- –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è:
  ```sh
  terraform apply
  ```
- –í–∏–¥–∞–ª–µ–Ω–Ω—è:
  ```sh
  terraform destroy
  ```

---

## üöÄ –î–µ–ø–ª–æ–π Django –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –∑ Helm

1. **–ó–±—ñ—Ä–∫–∞ —Ç–∞ –ø—É—à Docker-–æ–±—Ä–∞–∑—É:**
   ```sh
   docker build --platform linux/amd64 -t <ecr-repo>:<tag> .
   docker push <ecr-repo>:<tag>
   ```
2. **–û–Ω–æ–≤—ñ—Ç—å `lesson-7/charts/values.yaml` –∑ –≤–∞—à–∏–º –æ–±—Ä–∞–∑–æ–º.**
3. **–î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Helm:**
   ```sh
   helm upgrade --install lesson-7 ./lesson-7/charts
   ```
4. **–ó–Ω–∞–π–¥—ñ—Ç—å EXTERNAL-IP:**
   ```sh
   kubectl get svc
   ```
   –í—ñ–¥–∫—Ä–∏–π—Ç–µ —É –±—Ä–∞—É–∑–µ—Ä—ñ (–ø–æ—Ä—Ç 80 –∞–±–æ 8000).
5. **HPA:** –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –≤—ñ–¥ 2 –¥–æ 6 –ø–æ–¥—ñ–≤ –ø—Ä–∏ CPU > 70% (–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —É
   values.yaml).

---

## üß© Jenkins CI/CD –º–æ–¥—É–ª—å

- **–î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Terraform:** –º–æ–¥—É–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î Jenkins —É EKS —á–µ—Ä–µ–∑
  Helm.
- **–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è:** PVC –∑ EBS (StorageClass `gp2` –∞–±–æ `ebs-sc`).
- **Seed-job:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î pipeline –¥–ª—è Django –∑ GitHub-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
  (Job DSL).
- **PAT:** –ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ GitHub PAT —è–∫ Jenkins Credential (`github-token`). –ù–µ
  —Ö–∞—Ä–¥–∫–æ–¥—å—Ç–µ —É —Ñ–∞–π–ª–∞—Ö!
- **–î–æ—Å—Ç—É–ø:**

  ```sh
  kubectl get svc -n jenkins
  ```

  –í—ñ–¥–∫—Ä–∏–π—Ç–µ EXTERNAL-IP:8080 —É –±—Ä–∞—É–∑–µ—Ä—ñ.

  ### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è deployment pipeline

  1. –ü—ñ—Å–ª—è –≤—Ö–æ–¥—É –≤ Jenkins –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ **seed-job** –Ω–∞ –≥–æ–ª–æ–≤–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ
     Dashboard.
  2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ **seed-job** pipeline —ñ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –æ–±–µ—Ä—ñ—Ç—å **Build now**
  3. –î–ª—è –ø–µ—Ä—à–æ–≥–æ –∑–∞–ø—É—Å–∫—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø—ñ–¥–≤—Ç–µ—Ä–¥–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç, –¥–ª—è —Ü—å–æ–≥–æ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –≤
     **Dashboard -> Manage Jenkins -> In-process Script Approval** —Ç–∞
     –ø—ñ–¥–≤—Ç–µ—Ä–¥—å—Ç–µ **seed-job**
  4. –£ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **seed-job** –º–∞—î —Å—Ç–≤–æ—Ä–∏—Ç–∏—Å—è pipeline
     **goit-django-docker**
  5. –ó–∞–ø—É—Å–∫ **goit-django-docker** –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –¥—ñ–π:
     - –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ **kaniko** –∑–±–∏—Ä–∞—î—Ç—å—Å—è image –∑
       **django-app/Dockerfile** —Ç–∞ –ø—É–±–ª—ñ–∫—É—î—Ç—å—Å—è –≤ **ECR** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
     - –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ **git** –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∫–æ–º–º—ñ—Ç –≤ –ø–æ—Ç–æ—á–Ω–∏–π git
       —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π, –∞ —Å–∞–º–µ - –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–Ω—è **image.tag** —É —Ñ–∞–π–ª—ñ
       **charts/values.yaml**
     - –æ–Ω–æ–≤–ª–µ–Ω–Ω—è **charts/values.yaml** –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–µ–ø–ª–æ—é
       **django-app** –≤ Argo CD

---

## üêô Argo CD –º–æ–¥—É–ª—å

- **–î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Terraform:** –º–æ–¥—É–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î Argo CD —É EKS —á–µ—Ä–µ–∑
  Helm.
- **–î–æ—Å—Ç—É–ø:**

  ```sh
  kubectl get svc -n argocd
  ```

  –í—ñ–¥–∫—Ä–∏–π—Ç–µ EXTERNAL-IP:8080 —É –±—Ä–∞—É–∑–µ—Ä—ñ.

  **–õ–æ–≥—ñ–Ω:** admin

  –©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **–ø–∞—Ä–æ–ª—å** –≤–∏–∫–æ–Ω–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É —ñ —Å–∫–æ–ø—ñ—é–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

  ```sh
  kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d
  ```

![Argo CD Dashboard](/assets/img/argo-cd-dashboard.png 'Argo CD Dashboard')

–ü—ñ—Å–ª—è –≤—Ö–æ–¥—É –¥–æ–¥–∞—Ç–æ–∫ –º–∞—î –±—É—Ç–∏ –≤ —Å—Ç–∞—Ç—É—Å—ñ Healthy:

---

## üîí –ë–µ–∑–ø–µ–∫–∞

- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ IAM —Ä–æ–ª—ñ, –Ω–µ access keys
- –®–∏—Ñ—Ä—É–π—Ç–µ —Å—Ç–∞–Ω —É S3
- –ù–µ –∑–±–µ—Ä—ñ–≥–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç–∏ —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É –≤–∏–≥–ª—è–¥—ñ
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Jenkins Credentials –¥–ª—è PAT
- –ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ —Ä–µ—Å—É—Ä—Å–∏ —Ç–∞ –ª–æ–≥–∏

---

## üõ†Ô∏è Troubleshooting

- **PVC Pending:** –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ StorageClass, –ø—Ä–∞–≤–∞ AWS, –ª–æ–≥–∏ pod-–∞
- **Jenkins –Ω–µ —Å—Ç–∞—Ä—Ç—É—î:** –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ pod-–∞, PVC, —Ä–µ—Å—É—Ä—Å–∏
- **LoadBalancer –±–µ–∑ EXTERNAL-IP:** –∑–∞—á–µ–∫–∞–π—Ç–µ –∞–±–æ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ cloud-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- **kubectl –Ω–µ –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è:** –æ–Ω–æ–≤—ñ—Ç—å kubeconfig —á–µ—Ä–µ–∑ AWS CLI
- **Helm release failed:** –≤–∏–¥–∞–ª—ñ—Ç—å —Å—Ç–∞—Ä–∏–π release
  (`helm uninstall <name> -n <ns>`)

---

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —Ü—ñ–ª–µ–π.

---

**–ê–≤—Ç–æ—Ä:** [–ü–æ–¥–æ–ø—Ä–∏–≥–æ—Ä–∞ –ú–∏–∫–æ–ª–∞]  
**–í–µ—Ä—Å—ñ—è:** 0.0.9
